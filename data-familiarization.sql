/* Data Familiarization: 
Begin by understanding the datasets provided. Explore the columns, types of 
data, and any missing values.
Familiarize yourself with the platforms 
(Instagram, Facebook, Twitter, LinkedIn) from which the data originates 
to understand the context.
*/

/* STEP 1 - CREATE DATA STAGE TABLE IN POSTGRESQL */

CREATE TABLE rawdata_stage (
    date_column timestamp,
    post_id text,
    network text,
    post_type text,
    content_type text,
    profile text,
    sent_by text,
    link text,
    post text,
    linked_content text,
    impressions text,
    organic_impressions text,
    viral_impressions text,
    non_viral_impressions text,
    paid_impressions text,
    fan_impressions text,
    fan_organic_impressions text,
    fan_paid_impressions text,
    non_fan_impressions text,
    non_fan_organic_impressions text,
    non_fan_paid_impressions text,
    reach text,
    organic_reach text,
    viral_reach text,
    non_viral_reach text,
    paid_reach text,
    fan_reach text,
    fan_paid_reach text,
    potential_reach text,
    engagement_rate_per_impression text,
    engagement_rate_per_reach text,
    engagements text,
    reactions text,
    likes text,
    dislikes text,
    love_reactions text,
    haha_reactions text,
    wow_reactions text,
    sad_reactions text,
    angry_reactions text,
    comments text,
    shares text,
    saves text,
    click_through_rate text,
    post_link_clicks text,
    other_post_clicks text,
    post_clicks_all text,
    post_media_clicks text,
    post_hashtag_clicks text,
    post_detail_expand_clicks text,
    profile_clicks text,
    post_photo_view_clicks text,
    post_video_play_clicks text,
    other_engagements text,
    answers text,
    app_engagements text,
    app_install_attempts text,
    app_opens text,
    follows_from_post text,
    unfollows_from_post text,
    negative_feedback text,
    bit_ly_link_clicks text,
    engaged_users text,
    engaged_fans text,
    users_talking_about_this text,
    unique_reactions text,
    unique_comments text,
    unique_shares text,
    unique_answers text,
    unique_post_clicks text,
    unique_post_link_clicks text,
    unique_post_photo_view_clicks text,
    unique_post_video_play_clicks text,
    unique_other_post_clicks text,
    unique_negative_feedback text,
    subscribers_gained_from_video text,
    annotation_clicks text,
    card_clicks text,
    video_views text,
    media_views text,
    organic_video_views text,
    paid_video_views text,
    partial_video_views text,
    organic_partial_video_views text,
    paid_partial_video_views text,
    full_video_views text,
    full_video_view_rate text,
    follow_video_views text,
    for_you_video_views text,
    hashtag_video_views text,
    business_account_video_views text,
    sound_video_views text,
    unspecified_video_views text,
    organic_full_video_views text,
    paid_full_video_views text,
    autoplay_video_views text,
    click_to_play_video_views text,
    sound_on_video_views text,
    sound_off_video_views text,
    ten_second_video_views text,
    organic_10_second_video_views text,
    paid_10_second_video_views text,
    autoplay_10_second_video_views text,
    click_to_play_10_second_video_views text,
    sound_on_10_second_video_views text,
    sound_off_10_second_video_views text,
    autoplay_partial_video_views text,
    click_to_play_partial_video_views text,
    autoplay_full_video_views text,
    click_to_play_full_video_views text,
    nine_five_percent_video_views text,
    organic_95_percent_video_views text,
    paid_95_percent_video_views text,
    video_length_seconds text,
    average_video_time_watched_seconds text,
    video_view_time_seconds text,
    organic_video_view_time_seconds text,
    paid_video_view_time_seconds text,
    unique_video_views text,
    unique_organic_video_views text,
    unique_paid_video_views text,
    unique_10_second_video_views text,
    unique_full_video_views text,
    unique_organic_95_percent_video_views text,
    unique_paid_95_percent_video_views text,
    video_ad_break_ad_impressions text,
    video_ad_break_ad_earnings text,
    video_ad_break_ad_cost_per_impression_cpm text,
    youtube_premium_views text,
    estimated_minutes_watched text,
    estimated_premium_minutes_watched text,
    story_taps_back text,
    story_taps_forward text,
    story_exits text,
    story_replies text,
    video_added_to_playlists text,
    subscribers_lost_from_video text,
    video_removed_from_playlists text,
    annotation_impressions text,
    annotation_clickable_impressions text,
    annotation_closable_impressions text,
    annotation_closes text,
    card_impressions text,
    card_teaser_impressions text,
    card_teaser_clicks text,
    poll_votes text,
    tags text
);

/* STEP 2 - COPY RAW DATA FILE TO POSTGRES STAGE TABLES */
COPY facebook_stage
FROM 'C:\Users\Hp\Downloads\Facebook.csv'
DELIMITER ','
CSV HEADER;

COPY instagram_stage
FROM 'C:\Users\Hp\Downloads\Instagram.csv'
DELIMITER ','
CSV HEADER;

COPY linkedin_stage
FROM 'C:\Users\Hp\Downloads\Linkedin.csv'
DELIMITER ','
CSV HEADER;

COPY twitter_stage
FROM 'C:\Users\Hp\Downloads\Twitter.csv'
DELIMITER ','
CSV HEADER;